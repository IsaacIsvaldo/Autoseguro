<!DOCTYPE html>
<%- include partials/head.ejs %>

  <body>
    <div id="app">
      <div class="main-wrapper main-wrapper-1">
        <div class="navbar-bg"></div>
        <!--Nav bar-->
        <%- include partials/navbar.ejs %>
          <!--sidebar-->

          <%- include partials/sidebar.ejs %>
            <!-- Main Content -->
            <div class="main-content">
              <section class="section">
                <div class="section-header">
                  <h1>Profile</h1>
                  <div class="section-header-breadcrumb">
                    <div class="breadcrumb-item active"><a href="#"></a></div>
                    <div class="breadcrumb-item">Profile</div>
                  </div>
                </div>
                <div class="section-body">
                  <div class="row mt-sm-4">
                    <div class="col-12 col-md-12 col-lg-6">
                      <div class="card author-box card-primary">
                        <div class="card-body">
                          <div class="author-box-left">
                             <img alt="image" src="/uploads/<%= user.img %> " class="rounded-circle author-box-picture" data-toggle="tooltip" title="<%= user.name %>">
                             <div class="avatar-badge" title="Editar foto" data-toggle="tooltip"> <a href="/user/upload/<%= user.id %>"><i class="fas fa-camera"></i></a></div>
                          </div>
                          <div class="author-box-details">
                            <div class="author-box-name">
                              <a href="#"></a>
                            </div>
                            <div class="author-box-job"></div>
                            <div class="author-box-description">
                              <p>perfil de utilizador.</p>
                            </div>
                            <div class="mb-2 mt-3"><div class="text-small font-weight-bold"></div></div>
                           
                            <div class="w-100 d-sm-none"></div>
                            <div class="card-footer text-center">
                              <a href="#" class="btn btn-primary btn-round"  data-toggle="modal" data-target="#exampleModal">Editar perfil</a>
                             <hr>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-6">
                      <div class="card">
                        
                        <form method="post" class="needs-validation" novalidate="">
                          <div class="card-body">
                              <div class="row">                               
                                <div class="form-group col-md-6 col-12">
                                  <label for=""></label>
                                  <input type="text" class="form-control" disabled value="<%= user.name %>" required="">
                                  <div class="invalid-feedback">
                                    Please fill in the first name
                                  </div>
                                </div>
                                <div class="form-group col-md-6 col-12">
                                  <label for=""></label>
                                  <input type="text" class="form-control" disabled value="<%= user.user_name %>" required="">
                                  <div class="invalid-feedback">
                                    Please fill in the last name
                                  </div>
                                </div>
                              </div>
                              <div class="row">                               
                                <div class="form-group col-md-6 col-12">
                                
                                  <input type="text" class="form-control" disabled value="<%= user.provincia %>" required="">
                                  <div class="invalid-feedback">
                                    Please fill in the first name
                                  </div>
                                </div>
                                <div class="form-group col-md-6 col-12">
                              
                                  <input type="text" class="form-control" disabled value="<%= user.municipio %>" required="">
                                  <div class="invalid-feedback">
                                    Please fill in the last name
                                  </div>
                                </div>
                              </div>
                             
                         
                          </div>
                        </form>
                      </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-12">
                      <div class="card">
                        <a href="/user/add/veiculo" >
                          <h2><i class="ion-plus-circled" title="Adicionar veiculo" data-toggle="tooltip"  ></i></h2>
                        </a>
                        <div class="card-body">
                          <div class="card-header">
                           
                          <div class="table-responsive">
                            <table class="table table-striped" id="table-1">
                              <thead>                                 
                                <tr>
                                  <th class="text-center">
                                    #
                                  </th>
                                  <th>Marca</th>
                                  <th>Modelo</th>
                            
                                  <th>Matricula</th>
                                  <th>cor</th>
                                  <th>Accão</th>
                                </tr>
                              </thead>
                              <tbody>   
                                <% veiculo.forEach(veiculo => { %>                              
                                <tr>
                                  <td>
                                    <%= veiculo.id %> 
                                  </td>
                                  <td><%= veiculo.marca %> </td>
                                  <td><%= veiculo.modelo %> </td>
                                  <td><%= veiculo.matricula %> </td>
                                  <td><%= veiculo.cor %> </td>
                                
                                  <td>
                                    <div class=" dropdown">
                                      <a href="#" data-toggle="dropdown"><i class="fas fa-ellipsis-h"></i></a>
                                      <div class="dropdown-menu">
                                        <div class="dropdown-title">Opções</div>
                                        <a class="dropdown-item has-icon" href="/user/veiculo/descricao/<%= veiculo.matricula %>" title="Detalhes Usuário" data-toggle="tooltip"><i class="fas fa-eye"></i> Ver</a>
                                        <a  class="dropdown-item has-icon" href="/user/veiculo/update/<%= veiculo.id %> " title="Editar Veiculo" data-toggle="tooltip"><i class="fas fa-edit" ></i>Editar</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item has-icon text-danger" onclick="confirmar( `<%= veiculo.id %>`)"  title="Deletar Veiculo" data-toggle="tooltip"><i class="fas fa-trash-alt"></i> Deletar</a>
                                      </div>
                                    </div>
                                     
                                  </td>
                                </tr>
                               
                                <% }) %>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
     
                  </div>
                 </div>
              </section>
            </div>
            <footer class="main-footer">
              <div class="footer-left">
                Copyright &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </div>
              <div class="footer-right">

              </div>
              <div class="modal fade" tabindex="-1" role="dialog" id="exampleModal">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Modal title</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <form method="POST" action="/user/perfil/update" class="needs-validation" novalidate="">
                        <div class="row">
                          <div class="form-group col-6">
                            <label for="frist_name">Nome:</label>
                            <input id="frist_name" type="text" class="form-control" name="name"
                              value="<%= user.name %> " autofocus required>
                            <div class="invalid-feedback">
                              nome esta vazio

                            </div>
                          </div>
                          <div class="form-group col-6">
                            <label for="last_name">Username:</label>
                            <input id="last_name" type="text" class="form-control" name="user_name"
                              value="<%= user.user_name %> " autofocus required>
                            <div class="invalid-feedback">
                              nome de usuario esta vazio

                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-6">
                            <label for="frist_name">E-mail:</label>
                            <input id="frist_name" type="email" class="form-control" name="email"
                              value="<%= user.email %> " autofocus required>
                            <div class="invalid-feedback">
                              nome esta vazio

                            </div>
                          </div>
                          <div class="form-group col-6">
                            <label for="last_name">Contacto:</label>
                            <input id="last_name" type="text" class="form-control" name="tel" maxlength="9" value="<%= user.tel %> "
                              autofocus required>
                            <div class="invalid-feedback">
                              nome de usuario esta vazio

                            </div>
                          </div>
                        </div>
                      
                        
                          <div class="form-group">
                            <label for="frist_name">Endereço:</label>
                            <input id="frist_name" type="text" class="form-control" name="endereco"
                              value="<%= user.endereco %> " autofocus required>
                           
                          </div>
                     




                        <div class="form-divider">

                        </div>
                        <div class="row">
                          <div class="form-group col-6">
                            <label>Provincia:</label>
                            <select required class=" form-control " name="provincia" id="slctprovincia"
                              onchange="populate(this.id,'slctmunicipio')">

                              <option disabled="disabled" selected="selected"> Escolha a província</option>
                              <option value="luanda">Luanda</option>
                              <option value="benguela">Benguela</option>
                              <option value="bengo">Bengo</option>
                              <option value="bié">Bié</option>
                              <option value="cabinda">Cabinda</option>
                              <option value="cuando-cubango">Cuando-Cubango</option>
                              <option value="cuanza norte">Cuanza Norte</option>
                              <option value="cuanza sul">Cuanza Sul</option>
                              <option value="cunene">Cunene</option>
                              <option value="huambo">Huambo</option>
                              <option value="huíla">Huíla</option>
                              <option value="lunda norte">Lunda Norte</option>
                              <option value="lunda sul">Lunda Sul</option>
                              <option value="malange">Malange</option>
                              <option value="moxico">Moxico</option>
                              <option value="namibe">Namibe</option>
                              <option value="uíge">Uíge</option>
                              <option value="zaire">Zaire</option>

                            </select>
                            <div class="invalid-feedback">
                              Provincia esta vazio

                            </div>

                          </div>
                          <div class="form-group col-6">
                            <label>Municipio:</label>

                            <select required name="municipio" id="slctmunicipio" class="form-control">
                              <option disabled="disabled" selected="selected"> Escolha o municipio</option>
                            </select>
                            <div class="invalid-feedback">
                              Municipio esta vazio

                            </div>
                          </div>
                        </div>
                        <div class="row">
                        <div class="form-group col-6">
                       
                          <select required name="estado_civil" id="slctmunicipio" class="form-control">
                            <option disabled="disabled" selected="selected"> --Estado civil--</option>
                            <option value="SOLTEIRO">Solteiro</option>
                            <option value="CASADO">Casado</option>
                          </select>
                         
                        </div>
                        <div class="form-group col-6">
                       
                          <select required name="sexo" id="slctmunicipio" class="form-control">
                            <option disabled="disabled" selected="selected"> --sexo--</option>
                            <option value="MASCULINO">Masculino</option>
                            <option value="FEMININO">Feminino</option>
                          </select>
                         
                        </div>

                      </div>




                        <div class="form-group">
                          <div class="custom-control custom-checkbox">
                            <input type="checkbox" name="agree" class="custom-control-input" id="agree" autofocus
                              required>
                            <label class="custom-control-label" for="agree">I agree with the terms and
                              conditions</label>

                          </div>
                        </div>
                      

                              <div class="form-group">
                                <button type="submit" class="btn btn-primary btn-lg btn-block">
                                  Atualizar
                                </button>
                              </div>
                      </form>
                    </div>
                    <div class="modal-footer bg-whitesmoke br">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                    </div>
                  </div>
                </div>
              </div>
            </footer>
      </div>
    </div>
    <script src="/assets/modules/datatables/datatables.min.js"></script>
  <script src="/assets/modules/datatables/DataTables-1.10.16/js/dataTables.bootstrap4.min.js"></script>
  <script src="/assets/modules/datatables/Select-1.2.4/js/dataTables.select.min.js"></script>
  <script src="/assets/js/page/modules-datatables.js"></script>
  <script src="/assets/js/page/bootstrap-modal.js"></script>
   
    <script src="/assets/modules/sweetalert/sweetalert2.all.min.js"></script>
    <script>
      function confirmar(id){
        
    Swal.fire({
      title: 'Do you want to save the changes?',
    icon:'warning',
      showCancelButton: true,
      confirmButtonColor:'#3085d6',
      cancelButtonColor:'#d33',
      confirmButtonText: 'Confirmar',
    
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below   */
      if (result.isConfirmed) {
    
       window.location = '/user/delete/my_car/'+id;
      } else if (result.isDenied) {
        Swal.fire('Erro ao eliminar', '', 'info')
      }
    })
      }
      </script>
    <% if(certo.length >0){%>
      <script>
       Swal.fire(
      'Showw!',
      '<%=certo %>!',
      'success'
    )
  
      </script>
      <% }else if(errado.length >0) {%>
        <script>
          Swal.fire({
  icon: 'error',
  title: 'Oops...',
  text: '<%=errado %>!',
  
  })
          
        </script>
       
        <% }else if(info.length >0) {%>
          <script>
            Swal.fire({
    icon: 'info',
    title: 'Opa...',
    text: '<%=info %>!',
    
    })
            
          </script>
          <% }%>
    

    <%- include partials/footer.ejs %>